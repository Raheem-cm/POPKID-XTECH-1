eval(Buffer.from('aW1wb3J0IGRvdGVudiBmcm9tICdkb3RlbnYnOwpkb3RlbnYuY29uZmlnKCk7CmltcG9ydCB7IG1ha2VXQVNvY2tldCwgZmV0Y2hMYXRlc3RCYWlsZXlzVmVyc2lvbiwgRGlzY29ubmVjdFJlYXNvbiwgdXNlTXVsdGlGaWxlQXV0aFN0YXRlIH0gZnJvbSAnQHdoaXNrZXlzb2NrZXRzL2JhaWxleXMnOwppbXBvcnQgeyBIYW5kbGVyLCBDYWxsdXBkYXRlLCBHcm91cFVwZGF0ZSB9IGZyb20gJy4vcG9wa2lkL3BvcGtpZGQvcG9wa2lkZGQuanMnOwppbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJzsKaW1wb3J0IHBpbm8gZnJvbSAncGlubyc7CmltcG9ydCBmcyBmcm9tICdmcyc7CmltcG9ydCAnbm9kZS1jYWNoZSc7CmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnOwppbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnOwppbXBvcnQgJ2F4aW9zJzsKaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZy5janMnOwppbXBvcnQgYXV0b3JlYWN0IGZyb20gJy4vbGliL2F1dG9yZWFjdC5janMnOwppbXBvcnQgeyBmaWxlVVJMVG9QYXRoIH0gZnJvbSAndXJsJzsKaW1wb3J0IHsgRmlsZSB9IGZyb20gJ21lZ2Fqcyc7Cgpjb25zdCB7IGVtb2ppcywgZG9SZWFjdCB9ID0gYXV0b3JlYWN0Owpjb25zdCBhcHAgPSBleHByZXNzKCk7CmxldCB1c2VRUiA9IGZhbHNlOwpsZXQgaW5pdGlhbENvbm5lY3Rpb24gPSB0cnVlOwpjb25zdCBQT1JUID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCAzMDAwOwoKY29uc3QgTUFJTl9MT0dHRVIgPSBwaW5vKHsKICB0aW1lc3RhbXA6ICgpID0+IGAsInRpbWUiOiIke25ldyBEYXRlKCkudG9KU09OKCl9ImAKfSk7CmNvbnN0IGxvZ2dlciA9IE1BSU5fTE9HR0VSLmNoaWxkKHt9KTsKbG9nZ2VyLmxldmVsID0gInRyYWNlIjsKCmNvbnN0IF9fZmlsZW5hbWUgPSBmaWxlVVJMVG9QYXRoKGltcG9ydC5tZXRhLnVybCk7CmNvbnN0IF9fZGlybmFtZSA9IHBhdGguZGlybmFtZShfX2ZpbGVuYW1lKTsKY29uc3Qgc2Vzc2lvbkRpciA9IHBhdGguam9pbihfX2Rpcm5hbWUsICJzZXNzaW9uIik7CmNvbnN0IGNyZWRzUGF0aCA9IHBhdGguam9pbihzZXNzaW9uRGlyLCAiY3JlZHMuanNvbiIpOwoKaWYgKCFmcy5leGlzdHNTeW5jKHNlc3Npb25EaXIpKSB7CiAgZnMubWtkaXJTeW5jKHNlc3Npb25EaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pOwp9Cgphc3luYyBmdW5jdGlvbiBkb3dubG9hZFNlc3Npb25EYXRhKCkgewogIGNvbnNvbGUubG9nKCJEZWJ1Z2dpbmcgU0VTU0lPTl9JRDoiLCBjb25maWcuU0VTU0lPTl9JRCk7CiAgaWYgKCFjb25maWcuU0VTU0lPTl9JRCkgewogICAgY29uc29sZS5lcnJvcigi4p2MIFBsZWFzZSBhZGQgeW91ciBzZXNzaW9uIHRvIFNFU1NJT05fSUQgZW52ICEhIik7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIGNvbnN0IHNlc3Npb25EYXRhID0gY29uZmlnLlNFU1NJT05fSUQuc3BsaXQoIlBPUEtJRDs7OyIpWzFdOwogIGlmICghc2Vzc2lvbkRhdGEgfHwgIXNlc3Npb25EYXRhLmluY2x1ZGVzKCcjJykpIHsKICAgIGNvbnNvbGUuZXJyb3IoIuKdjCBJbnZhbGlkIFNFU1NJT05fSUQgZm9ybWF0ISBJdCBtdXN0IGNvbnRhaW4gYm90aCBmaWxlIElEIGFuZCBkZWNyeXB0aW9uIGtleS4iKTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgY29uc3QgW2ZpbGVJZCwgZmlsZUtleV0gPSBzZXNzaW9uRGF0YS5zcGxpdCgnIycpOwogIHRyeSB7CiAgICBjb25zb2xlLmxvZygi8J+UhCBEb3dubG9hZGluZyBTZXNzaW9uLi4uIik7CiAgICBjb25zdCBtZWdhRmlsZSA9IEZpbGUuZnJvbVVSTChgaHR0cHM6Ly9tZWdhLm56L2ZpbGUvJHtmaWxlSWR9IyR7ZmlsZUtleX1gKTsKICAgIGNvbnN0IGRvd25sb2FkZWQgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHsKICAgICAgbWVnYUZpbGUuZG93bmxvYWQoKGVyciwgZGF0YSkgPT4gewogICAgICAgIGlmIChlcnIpIHJlaihlcnIpOwogICAgICAgIGVsc2UgcmVzKGRhdGEpOwogICAgICB9KTsKICAgIH0pOwogICAgYXdhaXQgZnMucHJvbWlzZXMud3JpdGVGaWxlKGNyZWRzUGF0aCwgZG93bmxvYWRlZCk7CiAgICBjb25zb2xlLmxvZygi8J+UkiBTZXNzaW9uIFN1Y2Nlc3NmdWxseSBMb2FkZWQgISEiKTsKICAgIHJldHVybiB0cnVlOwogIH0gY2F0Y2ggKGVycikgewogICAgY29uc29sZS5lcnJvcigi4p2MIEZhaWxlZCB0byBkb3dubG9hZCBzZXNzaW9uIGRhdGE6IiwgZXJyKTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0KCmFzeW5jIGZ1bmN0aW9uIHN0YXJ0KCkgewogIHRyeSB7CiAgICBjb25zdCB7IHN0YXRlLCBzYXZlQ3JlZHMgfSA9IGF3YWl0IHVzZU11bHRpRmlsZUF1dGhTdGF0ZShzZXNzaW9uRGlyKTsKICAgIGNvbnN0IHsgdmVyc2lvbiwgaXNMYXRlc3QgfSA9IGF3YWl0IGZldGNoTGF0ZXN0QmFpbGV5c1ZlcnNpb24oKTsKICAgIGNvbnNvbGUubG9nKGDwn6SWIFBPUEtJRC1HTEUgdXNpbmcgV0EgdiR7dmVyc2lvbi5qb2luKCcuJyl9IHwgTGF0ZXN0OiAke2lzTGF0ZXN0fWApOwoKICAgIGNvbnN0IHNvY2sgPSBtYWtlV0FTb2NrZXQoewogICAgICB2ZXJzaW9uLAogICAgICBsb2dnZXI6IHBpbm8oeyBsZXZlbDogJ3NpbGVudCcgfSksCiAgICAgIHByaW50UVJJblRlcm1pbmFsOiB1c2VRUiwKICAgICAgYnJvd3NlcjogWydQT1BLSUQtR0xFJywgJ1NhZmFyaScsICczLjMnXSwKICAgICAgYXV0aDogc3RhdGUsCiAgICAgIGdldE1lc3NhZ2U6IGFzeW5jIGtleSA9PiB7CiAgICAgICAgaWYgKHN0b3JlKSB7CiAgICAgICAgICBjb25zdCBtc2cgPSBhd2FpdCBzdG9yZS5sb2FkTWVzc2FnZShrZXkucmVtb3RlSmlkLCBrZXkuaWQpOwogICAgICAgICAgcmV0dXJuIG1zZz8ubWVzc2FnZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHsgY29udmVyc2F0aW9uOiAncG9wa2lkLWdsZSB3aGF0c2FwcCB1c2VyIGJvdCcgfTsKICAgICAgfQogICAgfSk7CgogICAgc29jay5ldi5vbigiY29ubmVjdGlvbi51cGRhdGUiLCBhc3luYyAoeyBjb25uZWN0aW9uLCBsYXN0RGlzY29ubmVjdCB9KSA9PiB7CiAgICAgIGlmIChjb25uZWN0aW9uID09PSAiY2xvc2UiKSB7CiAgICAgICAgaWYgKGxhc3REaXNjb25uZWN0Py5lcnJvcj8ub3V0cHV0Py5zdGF0dXNDb2RlICE9PSBEaXNjb25uZWN0UmVhc29uLmxvZ2dlZE91dCkgewogICAgICAgICAgc3RhcnQoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoY29ubmVjdGlvbiA9PT0gIm9wZW4iKSB7CiAgICAgICAgaWYgKGluaXRpYWxDb25uZWN0aW9uKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhjaGFsay5ncmVlbigi4pyFIFBPUEtJRC1HTEUgaXMgbm93IG9ubGluZSEiKSk7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXdhaXQgc29jay5ncm91cEFjY2VwdEludml0ZSgiRkhERVBrQkJmMjgxc1VjZGoxN2VVOSIpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhjaGFsay5ncmVlbigi4pyFIFN1Y2Nlc3NmdWxseSBqb2luZWQgZ3JvdXAuIikpOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoY2hhbGsucmVkKCLinYwgRmFpbGVkIHRvIGpvaW4gZ3JvdXA6ICIgKyBlcnIubWVzc2FnZSkpOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHdlbGNvbWVJbWcgPSB7IHVybDogJ2h0dHBzOi8vZmlsZXMuY2F0Ym94Lm1vZS9hbG5qMzIuanBnJyB9OwogICAgICAgICAgc29jay5uZXdzbGV0dGVyRm9sbG93KCIxMjAzNjM0MjAzNDI1NjY1NjJAbmV3c2xldHRlciIpOwogICAgICAgICAgc29jay5uZXdzbGV0dGVyRm9sbG93KCIxMjAzNjM0MjAzNDI1NjY1NjJAbmV3c2xldHRlciIpOwogICAgICAgICAgYXdhaXQgc29jay5zZW5kTWVzc2FnZShzb2NrLnVzZXIuaWQsIHsKICAgICAgICAgICAgaW1hZ2U6IHdlbGNvbWVJbWcsCiAgICAgICAgICAgIGNhcHRpb246IGAK4pWU4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCuKVkSAq4pyFUE9QS0lEIENPTk5FQ1RFRCoK4pWg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQCuKVkSAq4pqhREVWIFBPUEtJRCBHTEUqCuKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkArilZEgKuKMm05VTSBERVYgOisyNTQxMTEzODU3NDcqCuKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkGAsCiAgICAgICAgICAgIGNvbnRleHRJbmZvOiB7CiAgICAgICAgICAgICAgaXNGb3J3YXJkZWQ6IHRydWUsCiAgICAgICAgICAgICAgZm9yd2FyZGluZ1Njb3JlOiA5OTksCiAgICAgICAgICAgICAgZm9yd2FyZGVkTmV3c2xldHRlck1lc3NhZ2VJbmZvOiB7CiAgICAgICAgICAgICAgICBuZXdzbGV0dGVySmlkOiAiMTIwMzYzNDIwMzQyNTY2NTYyQG5ld3NsZXR0ZXIiLAogICAgICAgICAgICAgICAgbmV3c2xldHRlck5hbWU6ICJQT1BLSUQtR0xFIiwKICAgICAgICAgICAgICAgIHNlcnZlck1lc3NhZ2VJZDogLTEKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGV4dGVybmFsQWRSZXBseTogewogICAgICAgICAgICAgICAgdGl0bGU6ICJQT1BLSUQtR0xFIiwKICAgICAgICAgICAgICAgIGJvZHk6ICLhtJjhtI/htKHhtIfKgOG0h+G0hSDKmcqPIHBvcGtpZC1nbGUiLAogICAgICAgICAgICAgICAgdGh1bWJuYWlsVXJsOiAiaHR0cHM6Ly9maWxlcy5jYXRib3gubW9lL2FsbmozMi5qcGciLAogICAgICAgICAgICAgICAgc291cmNlVXJsOiAiaHR0cHM6Ly93aGF0c2FwcC5jb20vY2hhbm5lbC8wMDI5VmFkUXJOSThLTXFvNzlCaUhyM2wiLAogICAgICAgICAgICAgICAgbWVkaWFUeXBlOiAxLAogICAgICAgICAgICAgICAgcmVuZGVyTGFyZ2VyVGh1bWJuYWlsOiBmYWxzZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgICAgaW5pdGlhbENvbm5lY3Rpb24gPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coY2hhbGsuYmx1ZSgi4pm777iPIENvbm5lY3Rpb24gcmVlc3RhYmxpc2hlZCBhZnRlciByZXN0YXJ0LiIpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwoKICAgIHNvY2suZXYub24oImNyZWRzLnVwZGF0ZSIsIHNhdmVDcmVkcyk7CiAgICBzb2NrLmV2Lm9uKCJtZXNzYWdlcy51cHNlcnQiLCBtID0+IEhhbmRsZXIobSwgc29jaywgbG9nZ2VyKSk7CiAgICBzb2NrLmV2Lm9uKCJjYWxsIiwgYyA9PiBDYWxsdXBkYXRlKGMsIHNvY2spKTsKICAgIHNvY2suZXYub24oImdyb3VwLXBhcnRpY2lwYW50cy51cGRhdGUiLCBnID0+IEdyb3VwVXBkYXRlKHNvY2ssIGcpKTsKCiAgICBpZiAoY29uZmlnLk1PREUgPT09ICdwdWJsaWMnKSB7CiAgICAgIHNvY2sucHVibGljID0gdHJ1ZTsKICAgIH0gZWxzZSBpZiAoY29uZmlnLk1PREUgPT09ICdwcml2YXRlJykgewogICAgICBzb2NrLnB1YmxpYyA9IGZhbHNlOwogICAgfQoKICAgIHNvY2suZXYub24oIm1lc3NhZ2VzLnVwc2VydCIsIGFzeW5jIG0gPT4gewogICAgICB0cnkgewogICAgICAgIGNvbnN0IG1zZyA9IG0ubWVzc2FnZXNbMF07CiAgICAgICAgaWYgKCFtc2cua2V5LmZyb21NZSAmJiBjb25maWcuQVVUT19SRUFDVCAmJiBtc2cubWVzc2FnZSkgewogICAgICAgICAgY29uc3QgZW1vamkgPSBlbW9qaXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZW1vamlzLmxlbmd0aCldOwogICAgICAgICAgYXdhaXQgZG9SZWFjdChlbW9qaSwgbXNnLCBzb2NrKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJBdXRvIHJlYWN0IGVycm9yOiIsIGUpOwogICAgICB9CiAgICB9KTsKCiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5lcnJvcigiQ3JpdGljYWwgRXJyb3I6IiwgZSk7CiAgICBwcm9jZXNzLmV4aXQoMSk7CiAgfQp9Cgphc3luYyBmdW5jdGlvbiBpbml0KCkgewogIGlmIChmcy5leGlzdHNTeW5jKGNyZWRzUGF0aCkpIHsKICAgIGNvbnNvbGUubG9nKCLwn5SSIFNlc3Npb24gZmlsZSBmb3VuZCwgcHJvY2VlZGluZyB3aXRob3V0IFFSLiIpOwogICAgYXdhaXQgc3RhcnQoKTsKICB9IGVsc2UgewogICAgY29uc3QgZG93bmxvYWRlZCA9IGF3YWl0IGRvd25sb2FkU2Vzc2lvbkRhdGEoKTsKICAgIGlmIChkb3dubG9hZGVkKSB7CiAgICAgIGNvbnNvbGUubG9nKCLinIUgU2Vzc2lvbiBkb3dubG9hZGVkLCBzdGFydGluZyBib3QuIik7CiAgICAgIGF3YWl0IHN0YXJ0KCk7CiAgICB9IGVsc2UgewogICAgICBjb25zb2xlLmxvZygi4p2MIE5vIHNlc3Npb24gZm91bmQgb3IgaW52YWxpZCwgcHJpbnRpbmcgUVIuIik7CiAgICAgIHVzZVFSID0gdHJ1ZTsKICAgICAgYXdhaXQgc3RhcnQoKTsKICAgIH0KICB9Cn0KaW5pdCgpOwoKYXBwLnVzZShleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCAibXlkYXRhIikpKTsKYXBwLmdldCgnLycsIChyZXEsIHJlcykgPT4gewogIHJlcy5zZW5kRmlsZShwYXRoLmpvaW4oX19kaXJuYW1lLCAibXlkYXRhIiwgImluZGV4Lmh0bWwiKSk7Cn0pOwphcHAubGlzdGVuKFBPUlQsICgpID0+IHsKICBjb25zb2xlLmxvZyhg8J+MkCBTZXJ2ZXIgcnVubmluZyBvbiBwb3J0ICR7UE9SVH1gKTsKfSk7Cg==', 'base64').toString())
